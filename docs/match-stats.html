<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Head-to-Head Stats</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --home-gradient: linear-gradient(45deg, #e74c3c, #c0392b);
            --away-gradient: linear-gradient(45deg, #2c3e50, #34495e);
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --border-color: #ecf0f1;
            --glass-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
            --hover-bg: rgba(52, 152, 219, 0.05);
            --border-radius: 20px;
            --border-radius-sm: 10px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            color: var(--text-dark);
            padding: 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header Components */
        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .back-button {
            background: var(--glass-bg);
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 16px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .back-button:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .header {
            background: var(--glass-bg);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: var(--shadow);
            backdrop-filter: blur(20px);
        }

        .match-title {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-bottom: 10px;
            color: var(--text-dark);
            font-weight: 700;
        }

        .match-details {
            color: var(--text-light);
            font-size: clamp(1rem, 2vw, 1.2rem);
        }

        /* Stats Components */
        .stats-grid {
            display: grid;
            gap: 25px;
            margin-bottom: 30px;
        }

        .stats-section {
            background: var(--glass-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            backdrop-filter: blur(20px);
        }

        .section-header {
            padding: 20px;
            font-size: 1.4rem;
            font-weight: 700;
            text-align: center;
            color: white;
        }

        .team-stats-header { background: var(--home-gradient); }
        .player-stats-header { background: var(--away-gradient); }

        .stat-row {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            padding: 12px 20px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s ease;
        }

        .stat-row:hover { background: var(--hover-bg); }
        .stat-row:last-child { border-bottom: none; }

        .stat-value {
            font-weight: 700;
            font-size: 1.1rem;
            padding: 8px 15px;
            border-radius: var(--border-radius-sm);
            color: white;
        }

        .stat-label {
            text-align: center;
            font-weight: 600;
            color: var(--text-dark);
            min-width: 140px;
            font-size: 0.95rem;
        }

        .home-stat {
            text-align: right;
            background: var(--home-gradient);
        }

        .away-stat {
            text-align: left;
            background: var(--away-gradient);
        }

        /* Table Components */
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .player-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        .player-table th {
            background: var(--text-dark);
            color: white;
            padding: 15px 8px;
            text-align: center;
            font-weight: 600;
            border-right: 1px solid #2c3e50;
            white-space: nowrap;
            font-size: 0.85rem;
            min-width: 80px;
            vertical-align: middle;
        }

        .player-table th:first-child {
            text-align: left;
            padding-left: 12px;
            min-width: 180px;
            width: 180px;
        }

        .player-table td {
            padding: 12px 8px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
            border-right: 1px solid var(--border-color);
            font-size: 0.9rem;
            vertical-align: middle;
            min-width: 80px;
        }

        .player-table tr:hover { background: var(--hover-bg); }

        .player-name {
            text-align: left !important;
            font-weight: 600;
            color: var(--text-dark);
            white-space: nowrap;
            min-width: 180px !important;
            width: 180px !important;
            padding-left: 12px !important;
        }

        .highlight-stat {
            background: var(--success-color);
            color: white;
            border-radius: 8px;
            font-weight: 700;
            padding: 4px 8px;
        }

        /* Visual Elements */
        .section-divider {
            height: 3px;
            background: linear-gradient(90deg, var(--danger-color), var(--text-dark));
            margin: 30px 0;
            border-radius: 2px;
        }

        .vs-divider {
            margin: 20px 0;
            text-align: center;
            font-weight: 700;
            color: var(--text-dark);
            font-size: 1.2rem;
        }

        .foul-history {
            display: flex;
            gap: 4px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

        .foul-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            display: inline-block;
            cursor: help;
            transition: transform 0.2s ease;
        }

        .foul-dot:hover { transform: scale(1.2); }

        .foul-dot.committed {
            background: var(--success-color);
            box-shadow: 0 2px 4px rgba(39, 174, 96, 0.3);
        }

        .foul-dot.none {
            background: var(--danger-color);
            box-shadow: 0 2px 4px rgba(231, 76, 60, 0.3);
        }

        .foul-dot.did-not-play {
            background: transparent;
            border: 2px solid #95a5a6;
            width: 14px;
            height: 14px;
            box-shadow: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body { padding: 15px; }
            
            .top-nav {
                flex-direction: column;
                align-items: stretch;
                margin-bottom: 15px;
            }
            
            .back-button {
                width: fit-content;
                align-self: flex-start;
                font-size: 14px;
                padding: 10px 16px;
            }
            
            .header {
                padding: 20px 15px;
                margin-bottom: 20px;
            }
            
            .stats-grid { gap: 15px; }
            
            .section-header {
                padding: 15px 10px;
                font-size: 1.2rem;
            }
            
            .stat-row {
                grid-template-columns: 1fr;
                gap: 10px;
                text-align: center;
                padding: 15px;
            }
            
            .stat-label {
                order: -1;
                margin-bottom: 10px;
                min-width: auto;
            }
            
            .stat-value {
                font-size: 1rem;
                padding: 6px 12px;
                margin: 0 auto;
                width: fit-content;
            }
            
            .home-stat, .away-stat { text-align: center; }
            
            .player-table th,
            .player-table td {
                padding: 8px 4px;
                font-size: 0.8rem;
                min-width: 60px;
            }
            
            .player-table th:first-child,
            .player-table td:first-child {
                min-width: 120px;
                width: 120px;
            }
            
            .player-name {
                font-size: 0.8rem;
                min-width: 120px !important;
                width: 120px !important;
                padding-left: 8px !important;
            }
            
            .foul-dot {
                width: 12px;
                height: 12px;
            }
            
            .foul-dot.did-not-play {
                width: 8px;
                height: 8px;
            }
            
            .table-wrapper {
                margin: 0 -15px;
                padding: 0 15px;
            }
        }

        @media (max-width: 480px) {
            .player-table th,
            .player-table td {
                padding: 6px 4px;
                font-size: 0.75rem;
            }
            
            .stat-row { padding: 12px 10px; }
        }

        /* Loading state */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            * {
                transition: none !important;
                animation: none !important;
            }
        }

        /* Focus states for accessibility */
        .back-button:focus {
            outline: 2px solid #3498db;
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="top-nav" role="navigation">
            <button class="back-button" onclick="goBackToFixtures()" aria-label="Go back to fixtures">
                <span aria-hidden="true">←</span> 
                <span>Back to Fixtures</span>
            </button>
        </nav>
        
        <header class="header">
            <h1 class="match-title" id="matchTitle">Loading...</h1>
            <p class="match-details" id="matchDetails">Loading match details...</p>
        </header>

        <main class="stats-grid">
            <!-- Team Statistics Section -->
            <section class="stats-section" aria-labelledby="team-stats-header">
                <h2 class="section-header team-stats-header" id="team-stats-header">
                    Team Statistics (Season Averages)
                </h2>
                
                <div role="table" aria-label="Team comparison statistics">
                    <div class="stat-row">
                        <div class="stat-value home-stat">1.43</div>
                        <div class="stat-label">Goals Scored</div>
                        <div class="stat-value away-stat">2.21</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">0.76</div>
                        <div class="stat-label">Goals Conceded</div>
                        <div class="stat-value away-stat">1.12</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">12.4</div>
                        <div class="stat-label">Total Shots</div>
                        <div class="stat-value away-stat">16.8</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">9.2</div>
                        <div class="stat-label">Shots Against</div>
                        <div class="stat-value away-stat">11.5</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">4.2</div>
                        <div class="stat-label">On Target</div>
                        <div class="stat-value away-stat">6.1</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">3.1</div>
                        <div class="stat-label">Off Target</div>
                        <div class="stat-value away-stat">3.8</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">2.8</div>
                        <div class="stat-label">Blocked</div>
                        <div class="stat-value away-stat">4.5</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">89.5</div>
                        <div class="stat-label">Passing %</div>
                        <div class="stat-value away-stat">91.2</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">11.8</div>
                        <div class="stat-label">Fouls Committed</div>
                        <div class="stat-value away-stat">13.2</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">12.6</div>
                        <div class="stat-label">Fouls Won</div>
                        <div class="stat-value away-stat">11.4</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">5.3</div>
                        <div class="stat-label">Corners For</div>
                        <div class="stat-value away-stat">7.1</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">4.8</div>
                        <div class="stat-label">Corners Against</div>
                        <div class="stat-value away-stat">5.2</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">2.1</div>
                        <div class="stat-label">Cards For</div>
                        <div class="stat-value away-stat">1.8</div>
                    </div>
                    <div class="stat-row">
                        <div class="stat-value home-stat">2.3</div>
                        <div class="stat-label">Cards Against</div>
                        <div class="stat-value away-stat">2.0</div>
                    </div>
                </div>
            </section>

            <div class="section-divider" role="separator"></div>

            <!-- Defensive Statistics -->
            <section class="stats-section" aria-labelledby="defensive-stats-header">
                <h2 class="section-header player-stats-header" id="defensive-stats-header">
                    Defensive Statistics - Top 5 by Fouls Committed
                </h2>
                
                <div class="table-wrapper">
                    <table class="player-table" aria-label="Home team defensive statistics">
                        <thead>
                            <tr>
                                <th scope="col">Home Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Fouls Committed<br/>(avg/game)</th>
                                <th scope="col">Tackles Made<br/>(avg/game)</th>
                                <th scope="col">Cards<br/>(Total)</th>
                                <th scope="col">Last 5 Games<br/>Foul History</th>
                                <th scope="col">Potential<br/>Opponent</th>
                            </tr>
                        </thead>
                        <tbody id="homeDefensiveStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>

                <div class="vs-divider" role="separator">VS</div>

                <div class="table-wrapper">
                    <table class="player-table" aria-label="Away team defensive statistics">
                        <thead>
                            <tr>
                                <th scope="col">Away Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Fouls Committed<br/>(avg/game)</th>
                                <th scope="col">Tackles Made<br/>(avg/game)</th>
                                <th scope="col">Cards<br/>(Total)</th>
                                <th scope="col">Last 5 Games<br/>Foul History</th>
                                <th scope="col">Potential<br/>Opponent</th>
                            </tr>
                        </thead>
                        <tbody id="awayDefensiveStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Offensive Statistics -->
            <section class="stats-section" aria-labelledby="offensive-stats-header">
                <h2 class="section-header team-stats-header" id="offensive-stats-header">
                    Offensive Statistics - Top 5 by Fouls Won
                </h2>
                
                <div class="table-wrapper">
                    <table class="player-table" aria-label="Home team offensive statistics">
                        <thead>
                            <tr>
                                <th scope="col">Home Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Fouls Won<br/>(avg/game)</th>
                                <th scope="col">Last 5 Games<br/>1+ Fouls Won</th>
                                <th scope="col">Last 5 Games<br/>2+ Fouls Won</th>
                                <th scope="col">Potential<br/>Opponent</th>
                            </tr>
                        </thead>
                        <tbody id="homeOffensiveStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>

                <div class="vs-divider" role="separator">VS</div>

                <div class="table-wrapper">
                    <table class="player-table" aria-label="Away team offensive statistics">
                        <thead>
                            <tr>
                                <th scope="col">Away Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Fouls Won<br/>(avg/game)</th>
                                <th scope="col">Last 5 Games<br/>1+ Fouls Won</th>
                                <th scope="col">Last 5 Games<br/>2+ Fouls Won</th>
                                <th scope="col">Potential<br/>Opponent</th>
                            </tr>
                        </thead>
                        <tbody id="awayOffensiveStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Shooting Statistics -->
            <section class="stats-section" aria-labelledby="shooting-stats-header">
                <h2 class="section-header player-stats-header" id="shooting-stats-header">
                    Shooting Statistics - Top 5 by Shots on Target
                </h2>
                
                <div class="table-wrapper">
                    <table class="player-table" aria-label="Home team shooting statistics">
                        <thead>
                            <tr>
                                <th scope="col">Home Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Shots on Target<br/>(avg/game)</th>
                                <th scope="col">Shots<br/>(avg/game)</th>
                            </tr>
                        </thead>
                        <tbody id="homeShootingStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>

                <div class="vs-divider" role="separator">VS</div>

                <div class="table-wrapper">
                    <table class="player-table" aria-label="Away team shooting statistics">
                        <thead>
                            <tr>
                                <th scope="col">Away Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Shots on Target<br/>(avg/game)</th>
                                <th scope="col">Shots<br/>(avg/game)</th>
                            </tr>
                        </thead>
                        <tbody id="awayShootingStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Goal Scoring Statistics -->
            <section class="stats-section" aria-labelledby="scoring-stats-header">
                <h2 class="section-header team-stats-header" id="scoring-stats-header">
                    Goal Scoring - Top 5 by Goals
                </h2>
                
                <div class="table-wrapper">
                    <table class="player-table" aria-label="Home team goal scoring statistics">
                        <thead>
                            <tr>
                                <th scope="col">Home Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Goals<br/>(Total)</th>
                                <th scope="col">Assists<br/>(avg/game)</th>
                                <th scope="col">Goals/Assists<br/>per game</th>
                            </tr>
                        </thead>
                        <tbody id="homeGoalStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>

                <div class="vs-divider" role="separator">VS</div>

                <div class="table-wrapper">
                    <table class="player-table" aria-label="Away team goal scoring statistics">
                        <thead>
                            <tr>
                                <th scope="col">Away Player</th>
                                <th scope="col">Mins<br/>(avg/game)</th>
                                <th scope="col">Goals<br/>(Total)</th>
                                <th scope="col">Assists<br/>(avg/game)</th>
                                <th scope="col">Goals/Assists<br/>per game</th>
                            </tr>
                        </thead>
                        <tbody id="awayGoalStats">
                            <!-- Dynamic content will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Data structure for better organization
        const matchData = {
            defensive: {
                home: [
                    { name: "F. Fabinho", minutes: 79, fouls: 2.4, tackles: 4.1, cards: 8, foulHistory: [2,3,1,2,0], opponent: "M. Ødegaard" },
                    { name: "A. Robertson", minutes: 85, fouls: 2.1, tackles: 3.4, cards: 5, foulHistory: [1,3,2,0,1], opponent: "B. Saka" },
                    { name: "T. Alexander-Arnold", minutes: 88, fouls: 1.8, tackles: 2.9, cards: 6, foulHistory: [2,1,0,3,'dnp'], opponent: "G. Martinelli" },
                    { name: "J. Henderson", minutes: 76, fouls: 1.6, tackles: 3.2, cards: 4, foulHistory: [1,2,1,0,2], opponent: "T. Partey" },
                    { name: "V. van Dijk", minutes: 90, fouls: 1.2, tackles: 4.8, cards: 2, foulHistory: [1,0,2,0,1], opponent: "G. Jesus" }
                ],
                away: [
                    { name: "T. Partey", minutes: 85, fouls: 2.2, tackles: 3.7, cards: 9, foulHistory: [3,1,0,2,1], opponent: "F. Fabinho" },
                    { name: "O. Zinchenko", minutes: 82, fouls: 1.9, tackles: 2.8, cards: 3, foulHistory: [2,0,1,3,0], opponent: "M. Salah" },
                    { name: "G. Gabriel", minutes: 87, fouls: 1.4, tackles: 3.2, cards: 7, foulHistory: [1,2,1,'dnp',0], opponent: "D. Núñez" },
                    { name: "B. White", minutes: 89, fouls: 1.1, tackles: 2.9, cards: 4, foulHistory: [0,1,2,0,1], opponent: "L. Díaz" },
                    { name: "W. Saliba", minutes: 90, fouls: 0.8, tackles: 3.9, cards: 2, foulHistory: [0,0,1,1,0], opponent: "R. Firmino" }
                ]
            },
            offensive: {
                home: [
                    { name: "M. Salah", minutes: 85, foulsWon: 3.2, opponent: "W. Saliba", foulHistory1Plus: [3,2,1,4,2], foulHistory2Plus: [3,2,0,4,2] },
                    { name: "L. Díaz", minutes: 78, foulsWon: 2.8, opponent: "B. White", foulHistory1Plus: [2,1,3,0,1], foulHistory2Plus: [2,0,3,0,0] },
                    { name: "D. Núñez", minutes: 82, foulsWon: 2.4, opponent: "G. Gabriel", foulHistory1Plus: [1,3,2,1,'dnp'], foulHistory2Plus: [0,3,2,0,'dnp'] },
                    { name: "R. Firmino", minutes: 71, foulsWon: 2.1, opponent: "T. Partey", foulHistory1Plus: [2,0,1,2,1], foulHistory2Plus: [2,0,0,2,0] },
                    { name: "A. Robertson", minutes: 85, foulsWon: 1.9, opponent: "B. Saka", foulHistory1Plus: [1,1,0,2,1], foulHistory2Plus: [0,0,0,2,0] }
                ],
                away: [
                    { name: "G. Martinelli", minutes: 81, foulsWon: 2.9, opponent: "T. Alexander-Arnold", foulHistory1Plus: [4,1,2,3,1], foulHistory2Plus: [4,0,2,3,0] },
                    { name: "B. Saka", minutes: 86, foulsWon: 2.7, opponent: "A. Robertson", foulHistory1Plus: [2,3,1,2,0], foulHistory2Plus: [2,3,0,2,0] },
                    { name: "G. Jesus", minutes: 89, foulsWon: 2.3, opponent: "V. van Dijk", foulHistory1Plus: [1,2,0,1,3], foulHistory2Plus: [0,2,0,0,3] },
                    { name: "M. Ødegaard", minutes: 88, foulsWon: 2.0, opponent: "F. Fabinho", foulHistory1Plus: [2,0,1,'dnp',2], foulHistory2Plus: [2,0,0,'dnp',2] },
                    { name: "E. Nketiah", minutes: 65, foulsWon: 1.8, opponent: "J. Matip", foulHistory1Plus: [0,1,1,2,1], foulHistory2Plus: [0,0,0,2,0] }
                ]
            },
            shooting: {
                home: [
                    { name: "M. Salah", minutes: 85, shotsOnTarget: 2.8, totalShots: 4.9 },
                    { name: "D. Núñez", minutes: 82, shotsOnTarget: 2.1, totalShots: 3.8 },
                    { name: "L. Díaz", minutes: 78, shotsOnTarget: 1.8, totalShots: 3.2 },
                    { name: "R. Firmino", minutes: 71, shotsOnTarget: 1.4, totalShots: 2.6 },
                    { name: "C. Gakpo", minutes: 68, shotsOnTarget: 1.2, totalShots: 2.3 }
                ],
                away: [
                    { name: "G. Jesus", minutes: 89, shotsOnTarget: 2.4, totalShots: 4.1 },
                    { name: "B. Saka", minutes: 86, shotsOnTarget: 2.0, totalShots: 3.6 },
                    { name: "G. Martinelli", minutes: 81, shotsOnTarget: 1.7, totalShots: 3.1 },
                    { name: "M. Ødegaard", minutes: 88, shotsOnTarget: 1.3, totalShots: 2.4 },
                    { name: "E. Nketiah", minutes: 65, shotsOnTarget: 1.1, totalShots: 2.1 }
                ]
            },
            goalScoring: {
                home: [
                    { name: "M. Salah", minutes: 85, goals: 24, assists: 0.42, perGame: 1.25, star: true },
                    { name: "D. Núñez", minutes: 82, goals: 18, assists: 0.26, perGame: 0.89 },
                    { name: "L. Díaz", minutes: 78, goals: 15, assists: 0.63, perGame: 0.94 },
                    { name: "R. Firmino", minutes: 71, goals: 9, assists: 0.37, perGame: 0.61 },
                    { name: "C. Gakpo", minutes: 68, goals: 7, assists: 0.21, perGame: 0.42 }
                ],
                away: [
                    { name: "G. Jesus", minutes: 89, goals: 21, assists: 0.37, perGame: 1.13, star: true },
                    { name: "B. Saka", minutes: 86, goals: 14, assists: 0.58, perGame: 0.96 },
                    { name: "G. Martinelli", minutes: 81, goals: 12, assists: 0.42, perGame: 0.74 },
                    { name: "M. Ødegaard", minutes: 88, goals: 8, assists: 0.47, perGame: 0.68 },
                    { name: "E. Nketiah", minutes: 65, goals: 6, assists: 0.16, perGame: 0.42 }
                ]
            }
        };

        // Utility functions
        const formatNumber = (num) => typeof num === 'number' ? num.toFixed(2) : num;
        
        const createFoulHistory = (history) => {
            return history.map(fouls => {
                if (fouls === 'dnp') {
                    return `<div class="foul-dot did-not-play" title="Did not play"></div>`;
                } else if (fouls === 0) {
                    return `<div class="foul-dot none" title="0 fouls committed"></div>`;
                } else {
                    return `<div class="foul-dot committed" title="${fouls} foul${fouls > 1 ? 's' : ''} committed"></div>`;
                }
            }).join('');
        };

        const createFoulWonHistory = (history, threshold) => {
            return history.map(fouls => {
                if (fouls === 'dnp') {
                    return `<div class="foul-dot did-not-play" title="Did not play"></div>`;
                } else if (fouls >= threshold) {
                    return `<div class="foul-dot committed" title="${fouls} foul${fouls > 1 ? 's' : ''} won"></div>`;
                } else {
                    return `<div class="foul-dot none" title="${fouls} foul${fouls > 1 ? 's' : ''} won (below ${threshold})"></div>`;
                }
            }).join('');
        };

        // Render functions for each table section
        const renderDefensiveStats = () => {
            const renderDefensiveRow = (player) => `
                <tr>
                    <td class="player-name">${player.name}</td>
                    <td>${player.minutes}</td>
                    <td class="${player.fouls >= 2.0 ? 'highlight-stat' : ''}">${formatNumber(player.fouls)}</td>
                    <td>${formatNumber(player.tackles)}</td>
                    <td>${player.cards}</td>
                    <td>
                        <div class="foul-history">
                            ${createFoulHistory(player.foulHistory)}
                        </div>
                    </td>
                    <td>${player.opponent}</td>
                </tr>
            `;

            document.getElementById('homeDefensiveStats').innerHTML = 
                matchData.defensive.home.map(renderDefensiveRow).join('');
            document.getElementById('awayDefensiveStats').innerHTML = 
                matchData.defensive.away.map(renderDefensiveRow).join('');
        };

        const renderOffensiveStats = () => {
            const renderOffensiveRow = (player) => `
                <tr>
                    <td class="player-name">${player.name}</td>
                    <td>${player.minutes}</td>
                    <td class="${player.foulsWon >= 2.5 ? 'highlight-stat' : ''}">${formatNumber(player.foulsWon)}</td>
                    <td>
                        <div class="foul-history">
                            ${createFoulWonHistory(player.foulHistory1Plus, 1)}
                        </div>
                    </td>
                    <td>
                        <div class="foul-history">
                            ${createFoulWonHistory(player.foulHistory2Plus, 2)}
                        </div>
                    </td>
                    <td>${player.opponent}</td>
                </tr>
            `;

            document.getElementById('homeOffensiveStats').innerHTML = 
                matchData.offensive.home.map(renderOffensiveRow).join('');
            document.getElementById('awayOffensiveStats').innerHTML = 
                matchData.offensive.away.map(renderOffensiveRow).join('');
        };

        const renderShootingStats = () => {
            const renderShootingRow = (player) => `
                <tr>
                    <td class="player-name">${player.name}</td>
                    <td>${player.minutes}</td>
                    <td class="${player.shotsOnTarget >= 2.0 ? 'highlight-stat' : ''}">${formatNumber(player.shotsOnTarget)}</td>
                    <td>${formatNumber(player.totalShots)}</td>
                </tr>
            `;

            document.getElementById('homeShootingStats').innerHTML = 
                matchData.shooting.home.map(renderShootingRow).join('');
            document.getElementById('awayShootingStats').innerHTML = 
                matchData.shooting.away.map(renderShootingRow).join('');
        };

        const renderGoalStats = () => {
            const renderGoalRow = (player) => `
                <tr>
                    <td class="player-name">${player.name}${player.star ? ' ⭐' : ''}</td>
                    <td>${player.minutes}</td>
                    <td class="${player.goals >= 20 ? 'highlight-stat' : ''}">${player.goals}</td>
                    <td>${formatNumber(player.assists)}</td>
                    <td class="${player.perGame >= 1.0 ? 'highlight-stat' : ''}">${formatNumber(player.perGame)}</td>
                </tr>
            `;

            document.getElementById('homeGoalStats').innerHTML = 
                matchData.goalScoring.home.map(renderGoalRow).join('');
            document.getElementById('awayGoalStats').innerHTML = 
                matchData.goalScoring.away.map(renderGoalRow).join('');
        };

        // Main initialization function
        const initializePage = () => {
            updateMatchInfo();
            renderDefensiveStats();
            renderOffensiveStats();
            renderShootingStats();
            renderGoalStats();
        };

        // Get URL parameters and update the page title and details
        const updateMatchInfo = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const homeTeam = urlParams.get('home') || 'Liverpool';
            const awayTeam = urlParams.get('away') || 'Arsenal';
            const time = urlParams.get('time') || '15:00';
            const date = urlParams.get('date') || new Date().toDateString();
            
            // Update the page title
            document.title = `${homeTeam} vs ${awayTeam} - Head-to-Head Stats`;
            
            // Update the match title
            const matchTitle = document.getElementById('matchTitle');
            matchTitle.textContent = `${homeTeam} vs ${awayTeam}`;
            
            // Format and update match details
            try {
                const dateObj = new Date(date);
                const formattedDate = dateObj.toLocaleDateString('en-GB', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                document.getElementById('matchDetails').textContent = 
                    `${formattedDate} • ${time} • Anfield Stadium`;
            } catch (error) {
                console.warn('Date parsing error:', error);
                document.getElementById('matchDetails').textContent = 
                    `${date} • ${time} • Anfield Stadium`;
            }
        };

        const goBackToFixtures = () => {
            // Check if there's a history to go back to
            if (window.history.length > 1) {
                window.history.back();
            } else {
                // Fallback to fixtures page
                window.location.href = 'index.html';
            }
        };

        // Event listeners
        document.addEventListener('DOMContentLoaded', initializePage);

        // Handle browser back button
        window.addEventListener('popstate', () => {
            goBackToFixtures();
        });

        // Handle keyboard navigation for accessibility
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                goBackToFixtures();
            }
        });

        // Performance optimization: Use passive event listeners where possible
        document.addEventListener('scroll', () => {
            // Add scroll-based animations or lazy loading here if needed
        }, { passive: true });

        // Error handling
        window.addEventListener('error', (event) => {
            console.error('Page error:', event.error);
            // Could implement user-friendly error reporting here
        });

        // Handle network status for potential offline functionality
        window.addEventListener('online', () => {
            console.log('Network connection restored');
        });

        window.addEventListener('offline', () => {
            console.log('Network connection lost');
        });
    </script>
</body>
</html>
